# What is LoRa/LoRaWAN???

## 1. LoRa : wireless MODULATION used to create long-range communication link (End Device)

- https://medium.com/kgxperience/what-happens-in-lora-lorawan-communication-ab32d56dfc71
- made by Semtech
- Physical Layer protocol
- Chirp Spread Spectrum(CSS) Modulation : 915MHz(USA)
    - low-frequency modulation
    - higher sensitivity â†’ enabling long-distance connectivity
    - 8 up chirps followed by 2 down chirpsâ€¦ and then data
- Power (Watt, W)
    - RF signal can be measured by Watt (W) using amplitude
    - $dBm = 10log^P(P : power, W)$
- Receive Sensitivity a minimum power that can receive signal
    - LoRa receiver is really sensitive, down to -148dBm
- RSSI (Received Signal Strength Indicator) ( - dBm; absolute)
    - https://www.thethingsnetwork.org/docs/lorawan/rssi-and-snr/
    - received signal strength, receive power, check if signal strength is strong enough to get a good wireless communication
    - LoRaì—ì„œëŠ” RSSI = -30dBm: strong, RSSI = -120dBm: weak
    - help to determine if the received signal is strong enough to get a good wireless connection
    - important for both gateways and end devices
    - closer to zero â†’ received signal is stronger
    - influenced by Path loss, Antenna gain, Cable/connector loss
- SNR (Signal-to-Noise Ratio) (dB; relative)
    - demodulationì˜ ê¸°ì¤€ì´ ë˜ëŠ” ì‹ í˜¸ì˜ quality
    - LoRaì—ì„œëŠ” -20dB and +10dB ì‚¬ì´
    - ratio of the received signal power to the noise floor
    - commonly used to determine the quality of the received signal
    - SNR(dB) = RSSI(dBm) - noise floor(dBm)
        - noise floor : amount of noise generated by the device
    - if the RSSI is above the noise floor(= positive SNR), the receiver can easily demodulate the signal
        
        <img width="678" alt="Screenshot 2024-01-18 at 9 36 35â€¯AM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/f4a10f93-1208-49a5-b4f6-c17dfd259dc9">
        
    - if negative SNR, it is impossible to demodulate the signal BUT LoRa CAN!!!
        
        <img width="678" alt="Screenshot 2024-01-18 at 9 35 58â€¯AM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/c6d02339-b839-4ef4-92dc-94b4869d8d53">
        
- Transmission Parameters
    - carrier frequency (CF)
        - just frequency
        - different frequencies + other info. â†’ channels
        - LoRaëŠ” ê°ê°ì˜ messageë§ˆë‹¤ randomí•˜ê²Œ channelì„ ì§€ì •í•¨
        - í•˜ë‚˜ì˜ channelì— ëŒ€ì‘ë˜ëŠ” BWì™€ SFê°€ ì¡´ì¬í•¨
    - bandwidth (BW) = chip rate (chips/sec = Hz)
        - range from CF - (1/2)BW to CF + (1/2)BW
        - 125kHz, 250kHz, 500kHz,
        - BW â¬†Â â†’ DR â¬†Â â†’ ToA â¬‡
    - ğŸŒŸğŸŒŸğŸŒŸSPREADING FACTOR (SF)
        - https://blog.ttulka.com/lora-spreading-factor-explained/
        - ì£¼ì–´ì§„ channelì˜ BWë‚´ì—ì„œ frequencyì˜ ë³€í™” ì†ë„, Signalì˜ íŠ¹ì„±
        - speed at which the signal frequency changes across the bandwidth of a channel in the time unit
        - distance â¬†Â â†’ SF â¬†Â â†’ DR â¬‡Â â†’ data sent slowly â†’ ToA â¬†Â â†’ SNR â¬†  â†’ receiver sensitivity â¬†
        - different SF â†’ orthogonal = received concurrently
        - SF â¬†Â â†’ receiver sensitivity â¬†
        - ğŸŒŸì‹ í˜¸ì˜ ì„¸ê¸°(RSSI)ê°€ weak â†’ SF â¬†Â â†’ receiver sensitivity â¬†, ì¦‰ weakí•œ ì‹ í˜¸ë¼ë„ receiverì—ì„œ ë°›ì„ ìˆ˜ ìˆìŒ
        - for each SF, there is a SNR limit(âˆµdemodulationì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸)
            
            <img width="634" alt="Screenshot 2024-01-18 at 9 33 37â€¯AM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/4d51838c-2555-4a84-9aba-3a3710d08c5b">
            
            - Ex. SF=7ì˜ signalì¼ ë•Œ SNRì´ -7.5dBë³´ë‹¤ ì‘ìœ¼ë©´ demodulation ë¶ˆê°€ëŠ¥
            - Receiver Sensitivity(S)ëŠ” BW, NF(receiver Noise Figure), SNR_limitì— ì˜í•´ ê³„ì‚°ê°€ëŠ¥
                - https://www.youtube.com/watch?v=NSjHWQMg6yo&list=PLmL13yqb6OxdeOi97EvI8QeO8o-PqeQ0g&index=16
                - NFëŠ” hardward implementationì— ì˜í•´ ê³ ì •
                - SNR_limitì€ SFì— ì˜í•´ ë‹¬ë¼ì§
                
                <img width="597" alt="Screenshot 2024-02-16 at 2 55 30â€¯PM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/2bd6a932-ef26-4d69-b0ee-c6b6616a91ab">
                <img width="543" alt="Screenshot 2024-02-16 at 2 54 24â€¯PM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/0093ca98-b51d-472d-b595-0622e994deaf">
                
                
    - coding rate (CR)
        - $CR = 4 / (4 + CR), CR = 1, 2, 3, 4$
        - proportion of the transmitted bits that actually carries info.
        - rest of them are for error correction
- half-duplex; bidirectional but not simultaneous
- reduce the amount of energy consumption

â€” by using asynchronous communication; end nodes only sends data when it is scheduled to â€˜wake upâ€™ or has data to send

- duty cycle
    - Ex. total allowed uplink ToA is 86400 sec(= one day) * 1% duty cycle = 864 seconds per day, per device

- some other metrics
    - Chip Rate = BW
    - Symbol Rate
    - Data Rate (DR; bits / sec)
        - also called Bit Rate (bits/sec)
        - computed by Bandwidth(BW), Spreading Factor(SF), Coding Rate(CR)
            
            <img width="296" alt="Screenshot 2024-01-29 at 10 15 11â€¯AM" src="https://github.com/JeongHwaSik/KSW_LoRa/assets/99574746/3e94f87e-4178-40da-9aee-198472602c05">
            
        - BW â¬†Â â†’ DR â¬†
        - distance â¬†Â â†’ SF â¬†Â â†’ DR â¬‡
        - CR â¬†Â â†’ DR â¬‡
- ğŸŒŸAdaptive Data Rate (ADR)
    
    - https://lora-developers.semtech.com/documentation/tech-papers-and-guides/understanding-adr
    
    - https://www.youtube.com/watch?v=C_Rh5GSENA4&list=PLmL13yqb6OxdeOi97EvI8QeO8o-PqeQ0g&index=17
    
    - goal : minimize energy consumption, maximize throughput
    - distance â¬‡Â â†’ power â¬‡Â â†’ SF â¬‡Â â†’ DR â¬†
    - only for fixed end node
    - network serverì—ì„œ ë°›ì€ 20ê°œì˜ uplink message ì¤‘ maximum SNR(SNR_measured)ì„ ê³ ë¦„, for less power
    - marginì„ ìµœì†Œí™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ SF, BW, Transmission power, CR ì„¤ì •
        - $margin = SNRmeasured - SNRlimit-default margin$
    - US902-928 : SF7BW125 ~ SF10BW125

